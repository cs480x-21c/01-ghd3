<html>
  <body>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-dispatch.v2.min.js"></script>
    <script src="https://d3js.org/d3-selection.v2.min.js"></script>
    <script src="https://d3js.org/d3-drag.v2.min.js"></script>
    <script>
      var drag = d3.drag();
    </script>
    <div id="main"></div>

    <script>
      console.log({ d3 }); // test if d3 is loaded

      // Add an SVG
      const svg = d3
        .select("#main")
        .append("svg")
        .attr("width", 600)
        .attr("height", 600);

      var toggleColor = (function () {
        var currentColor = "red";

        return function () {
          currentColor = currentColor == "red" ? "magenta" : "red";
          d3.select(this).style("fill", currentColor);
        };
      })();

      var drag = (function () {
        function dragstarted() {
          d3.select(this).attr("stroke", "black");
        }

        function dragged(event, d) {
          d3.select(this)
            .raise()
            .attr("cx", (d.x = event.x))
            .attr("cy", (d.y = event.y));
        }

        function dragended() {
          d3.select(this).attr("stroke", null);
        }

        return d3
          .drag()
          .on("start", dragstarted)
          .on("drag", dragged)
          .on("end", dragended);
      })();
      // Add Rectangles

      // Add Circles
      svg
        .append("circle")
        .attr("class", "shape circle")
        .attr("cx", 50)
        .attr("cy", 300)
        .attr("r", 25)
        //.on("click", toggleColor)
        //.call(drag)
        .style("fill", "red");
      // Add Lines

      const circles = d3.range(5).map((i) => ({
        x: 200 + 50 * i,
        y: 200 + 50 * i
      }));

      svg
        .selectAll("circle")
        .data(circles)
        .join("circle")
        .attr("cx", (d) => d.x)
        .attr("cy", (d) => d.y)
        .attr("r", 25)
        .attr("fill", (d, i) => d3.schemeCategory10[i % 10])
        .call(drag);

      const linScale = 20;
      const xLinPoints = [2, 1, 3, 2];
      const yLinPoints = [1, 3, 3, 5];
      var i;
      for (i = 0; i < xLinPoints.length - 1; i++) {
        svg
          .append("line")
          .attr("class", "shape lines")
          .attr("x1", xLinPoints[i] * linScale)
          .attr("y1", yLinPoints[i] * linScale)
          .attr("x2", xLinPoints[i + 1] * linScale)
          .attr("y2", yLinPoints[i + 1] * linScale)
          .style("stroke", "black")
          .style("stroke-width", 4);
      }

      // Add Polygons
    </script>
  </body>
</html>
